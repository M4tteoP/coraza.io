<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://coraza.io/main.c3725bcbcd2ff51ecac15f4d1500ceadd090464fa263927131acf5df644ea286bcb8cf3a6d9ad4c8f43be7247c1ffa871107cf9dd6dfe37546a9527fd5e2aa8d.css integrity="sha512-w3Jby80v9R7KwV9NFQDOrdCQRk+iY5JxMaz132ROooa8uM86bZrUyPQ75yR8H/qHEQfPndbf43VGqVJ/1eKqjQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Directives - OWASP Coraza WAF</title><meta name=description content="The following section outlines all of the Coraza directives. "><link rel=canonical href=https://coraza.io/docs/seclang/directives/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Directives"><meta property="og:description" content="The following section outlines all of the Coraza directives. "><meta property="og:url" content="https://coraza.io/docs/seclang/directives/"><meta property="og:site_name" content="OWASP Coraza WAF"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza WAF"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Directives"><meta name=twitter:description content="The following section outlines all of the Coraza directives. "><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Directives"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP oraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP oraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza WAF","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/directives/","url":"https://coraza.io/docs/seclang/directives/","name":"Directives","description":"The following section outlines all of the Coraza directives. ","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/directives/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/directives/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/directives/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Directives","description":"The following section outlines all of the Coraza directives. ","isPartOf":{"@id":"https://coraza.io/docs/seclang/directives/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/directives/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Directives"}]}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-1J0TK2GV0R"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1J0TK2GV0R")</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=https://coraza.io/>OWASP Coraza WAF</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://twitter.com/jptosso><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><span class="ms-2 visually-hidden">Twitter</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/jptosso/coraza-waf><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class=nav-link href=https://www.tosso.io/>Blog</a></li><li class=nav-item><a class=nav-link href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class=nav-link href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class=nav-link href=https://playground.coraza.io/>Playground</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li></ul><h3>Integrations</h3><h3>Seclang</h3><ul class=list-unstyled><li><a class="docs-link active" href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3>Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/logging/>Logging</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/roadmap/>Roadmap</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#secaction>SecAction</a></li><li><a href=#secargumentseparator>SecArgumentSeparator</a></li><li><a href=#secauditengine>SecAuditEngine</a></li><li><a href=#secauditlog>SecAuditLog</a></li><li><a href=#secauditlogparts>SecAuditLogParts</a></li><li><a href=#secauditlogrelevantstatus>SecAuditLogRelevantStatus</a></li><li><a href=#seccollectiontimeout>SecCollectionTimeout</a></li><li><a href=#seccomponentsignature>SecComponentSignature</a></li><li><a href=#seccontentinjection>SecContentInjection</a></li><li><a href=#secdatadir>SecDataDir</a></li><li><a href=#secdebuglog>SecDebugLog</a></li><li><a href=#secdebugloglevel>SecDebugLogLevel</a></li><li><a href=#secdefaultaction>SecDefaultAction</a></li><li><a href=#secdisablebackendcompression>SecDisableBackendCompression</a></li><li><a href=#sechashengine>SecHashEngine</a></li><li><a href=#sechashkey>SecHashKey</a></li><li><a href=#sechashparam>SecHashParam</a></li><li><a href=#sechashmethodrx>SecHashMethodRx</a></li><li><a href=#sechashmethodpm>SecHashMethodPm</a></li><li><a href=#secgeolookupdb>SecGeoLookupDb</a></li><li><a href=#sechttpblkey>SecHttpBlKey</a></li><li><a href=#secinterceptonerror>SecInterceptOnError</a></li><li><a href=#secmarker>SecMarker</a></li><li><a href=#secsensorid>SecSensorId</a></li><li><a href=#secremoterules>SecRemoteRules</a></li><li><a href=#secremoterulesfailaction>SecRemoteRulesFailAction</a></li><li><a href=#secrequestbodyaccess>SecRequestBodyAccess</a></li><li><a href=#secrequestbodyinmemorylimit>SecRequestBodyInMemoryLimit</a></li><li><a href=#secrequestbodylimit>SecRequestBodyLimit</a></li><li><a href=#secrequestbodynofileslimit>SecRequestBodyNoFilesLimit</a></li><li><a href=#secrequestbodylimitaction>SecRequestBodyLimitAction</a></li><li><a href=#secresponsebodylimit>SecResponseBodyLimit</a></li><li><a href=#secresponsebodylimitaction>SecResponseBodyLimitAction</a></li><li><a href=#secresponsebodymimetype>SecResponseBodyMimeType</a></li><li><a href=#secresponsebodymimetypesclear>SecResponseBodyMimeTypesClear</a></li><li><a href=#secresponsebodyaccess>SecResponseBodyAccess</a></li><li><a href=#secrule>SecRule</a></li><li><a href=#secruleengine>SecRuleEngine</a></li><li><a href=#secruleperftime>SecRulePerfTime</a></li><li><a href=#secruleremovebyid>SecRuleRemoveById</a></li><li><a href=#secruleremovebymsg>SecRuleRemoveByMsg</a></li><li><a href=#secruleremovebytag>SecRuleRemoveByTag</a></li><li><a href=#secruleupdateactionbyid>SecRuleUpdateActionById</a></li><li><a href=#secruleupdatetargetbyid>SecRuleUpdateTargetById</a></li><li><a href=#secruleupdatetargetbymsg>SecRuleUpdateTargetByMsg</a></li><li><a href=#secruleupdatetargetbytag>SecRuleUpdateTargetByTag</a></li><li><a href=#secunicodemap>SecUnicodeMap</a></li><li><a href=#secuploaddir>SecUploadDir</a></li><li><a href=#secuploadfilelimit>SecUploadFileLimit</a></li><li><a href=#secuploadfilemode>SecUploadFileMode</a></li><li><a href=#secuploadkeepfiles>SecUploadKeepFiles</a></li><li><a href=#secwebappid>SecWebAppId</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Use Cases</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Directives</li></ol></nav><h1>Directives</h1><p class=lead>The following section outlines all of the Coraza directives.</p><p>If you are looking to extend OWASP Core Ruleset, check this article.</p><p>Note : It is highly encouraged that you do not edit the Core rules files themselves but rather place all changes (such as SecRuleRemoveByID, etc&mldr;) in your custom rules file. This will allow for easier upgrading as newer Core rules are released.</p><h2 id=secaction>SecAction<a href=#secaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Unconditionally processes the action list it receives as the first and only parameter. The syntax of the parameter is identical to that of the third parameter of SecRule.</p><p><strong>Syntax:</strong> SecAction &ldquo;action1,action2,action3,&mldr;“</p><p>This directive is commonly used to set variables and initialize persistent collections using the initcol action. For example:</p><pre><code>SecAction nolog,phase:1,initcol:RESOURCE=%{REQUEST_FILENAME}
</code></pre><h2 id=secargumentseparator>SecArgumentSeparator<a href=#secargumentseparator class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Specifies which character to use as the separator for application/x-www-form- urlencoded content.</p><p><strong>Syntax:</strong> SecArgumentSeparator character</p><p><strong>Default:</strong> &</p><p>This directive is needed if a backend web application is using a nonstandard argument separator. Applications are sometimes (very rarely) written to use a semicolon separator. You should not change the default setting unless you establish that the application you are working with requires a different separator. If this directive is not set properly for each web application, then Coraza will not be able to parse the arguments appropriately and the effectiveness of the rule matching will be significantly decreased.</p><h2 id=secauditengine>SecAuditEngine<a href=#secauditengine class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the audit logging engine.</p><p><strong>Syntax:</strong> SecAuditEngine RelevantOnly</p><p><strong>Default:</strong> Off</p><p>The SecAuditEngine directive is used to configure the audit engine, which logs complete transactions. Coraza is currently able to log most, but not all transactions. Transactions involving errors (e.g., 400 and 404 transactions) use a different execution path, which Coraza does not support.</p><p>The possible values for the audit log engine are as follows:</p><ul><li><strong>On:</strong> log all transactions</li><li><strong>Off:</strong> do not log any transactions</li><li><strong>RelevantOnly:</strong> only the log transactions that have triggered a warning or an error, or have a status code that is considered to be relevant (as determined by the SecAuditLogRelevantStatus directive)</li></ul><p><strong>Note :</strong> If you need to change the audit log engine configuration on a per-transaction basis (e.g., in response to some transaction data), use the ctl action.
The following example demonstrates how SecAuditEngine is used:</p><pre><code>SecAuditEngine RelevantOnly
SecAuditLog logs/audit/audit.log
SecAuditLogParts ABCFHZ 
SecAuditLogType concurrent 
SecAuditLogStorageDir logs/audit 
SecAuditLogRelevantStatus ^(?:5|4(?!04))
</code></pre><h2 id=secauditlog>SecAuditLog<a href=#secauditlog class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines the path to the main audit log file (serial logging format) or the concurrent logging index file (concurrent logging format). When used in combination with mlogc (only possible with concurrent logging), this directive defines the mlogc location and command line.</p><p><strong>Syntax:</strong> SecAuditLog /path/to/audit.log</p><pre><code>SecAuditLog &quot;|/path/to/mlogc /path/to/mlogc.conf&quot;
</code></pre><p>Note : This audit log file is opened on startup when the server typically still runs as root. You should not allow non-root users to have write privileges for this file or for the directory.</p><h2 id=secauditlogparts>SecAuditLogParts<a href=#secauditlogparts class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines which parts of each transaction are going to be recorded in the audit log. Each part is assigned a single letter; when a letter appears in the list then the equivalent part will be recorded. See below for the list of all parts.</p><p><strong>Syntax:</strong> SecAuditLogParts PARTLETTERS</p><p><strong>Example Usage:</strong> SecAuditLogParts ABCFHZ</p><p>The format of the audit log format is documented in detail in the Audit Log Data Format Documentation.</p><p>Available audit log parts:</p><ul><li><strong>A:</strong> Audit log header (mandatory).</li><li><strong>B:</strong> Request headers.</li><li><strong>C:</strong> Request body (present only if the request body exists and Coraza is configured to intercept it. This would require SecRequestBodyAccess to be set to on).</li><li><strong>D:</strong> Reserved for intermediary response headers; not implemented yet.</li><li><strong>E:</strong> Intermediary response body (present only if Coraza is configured to intercept response bodies, and if the audit log engine is configured to record it. Intercepting response bodies requires SecResponseBodyAccess to be enabled). Intermediary response body is the same as the actual response body unless Coraza intercepts the intermediary response body, in which case the actual response body will contain the error message (either the Apache default error message, or the ErrorDocument page).</li><li><strong>F:</strong> Final response headers (excluding the Date and Server headers, which are always added by Apache in the late stage of content delivery).</li><li><strong>G:</strong> Reserved for the actual response body; not implemented yet.</li><li><strong>H:</strong> Audit log trailer.</li><li><strong>I:</strong> This part is a replacement for part C. It will log the same data as C in all cases except when multipart/form-data encoding in used. In this case, it will log a fake application/x-www-form-urlencoded body that contains the information about parameters but not about the files. This is handy if you don’t want to have (often large) files stored in your audit logs.</li><li><strong>J:</strong> This part contains information about the files uploaded using multipart/form-data encoding.</li><li><strong>K:</strong> This part contains a full list of every rule that matched (one per line) in the order they were matched. The rules are fully qualified and will thus show inherited actions and default operators.</li><li><strong>Z:</strong> Final boundary, signifies the end of the entry (mandatory).</li></ul><h2 id=secauditlogrelevantstatus>SecAuditLogRelevantStatus<a href=#secauditlogrelevantstatus class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures which response status code is to be considered relevant for the purpose of audit logging.</p><p><strong>Syntax:</strong> SecAuditLogRelevantStatus REGEX</p><p><strong>Example Usage:</strong> SecAuditLogRelevantStatus &ldquo;^(?:5|4(?!04))&rdquo;</p><p>Dependencies/Notes: Must have SecAuditEngine set to RelevantOnly. Additionally, the auditlog action is present by default in rules, this will make the engine bypass the &lsquo;SecAuditLogRelevantStatus&rsquo; and send rule matches to the audit log regardless of status. You must specify noauditlog in the rules manually or set it in SecDefaultAction.</p><p>The main purpose of this directive is to allow you to configure audit logging for only the transactions that have the status code that matches the supplied regular expression. The example provided would log all 5xx and 4xx level status codes, except for 404s. Although you could achieve the same effect with a rule in phase 5, SecAuditLogRelevantStatus is sometimes better, because it continues to work even when SecRuleEngine is disabled.</p><h2 id=seccollectiontimeout>SecCollectionTimeout<a href=#seccollectiontimeout class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Specifies the collections timeout. Default is 3600 seconds.</p><p><strong>Syntax:</strong> SecCollectionTimeout seconds</p><p><strong>Default:</strong> 3600</p><p><strong>Supported:</strong> No</p><h2 id=seccomponentsignature>SecComponentSignature<a href=#seccomponentsignature class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Appends component signature to the Coraza signature.</p><p><strong>Syntax:</strong> SecComponentSignature &ldquo;COMPONENT_NAME/X.Y.Z (COMMENT)&rdquo;</p><p><strong>Example Usage:</strong> SecComponentSignature &ldquo;core ruleset/2.1.3&rdquo;</p><p><strong>Supported:</strong> No</p><p>This directive should be used to make the presence of significant rule sets known. The entire signature will be recorded in the transaction audit log.</p><h2 id=seccontentinjection>SecContentInjection<a href=#seccontentinjection class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Enables content injection using actions append and prepend.</p><p><strong>Syntax:</strong> SecContentInjection On|Off</p><p><strong>Example Usage:</strong> SecContentInjection On</p><p><strong>Supported:</strong> TBI</p><p>This directive provides an easy way to control content injection, no matter what the rules want to do. It is not necessary to have response body buffering enabled in order to use content injection.</p><p>Note : This directive must ben enabled if you want to use @rsub + the STREAM_ variables to manipulate live transactional data.</p><h2 id=secdatadir>SecDataDir<a href=#secdatadir class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Path where persistent data (e.g., IP address data, session data, and so on) is to be stored.</p><p><strong>Syntax:</strong> SecDataDir /path/to/dir</p><p><strong>Example Usage:</strong> SecDataDir /usr/local/apache/logs/data</p><p><strong>Supported:</strong> No</p><p>This directive must be provided before initcol, setsid, and setuid can be used. The directory to which the directive points must be writable by the web server user.</p><p>Note : This directive is not allowed inside VirtualHosts. If enabled, it must be placed in a global server-wide configuration file such as your default Coraza.conf.
Note : SecDataDir is not currently supported. Collections are kept in memory (in_memory-per_process) for now.</p><h2 id=secdebuglog>SecDebugLog<a href=#secdebuglog class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Path to the Coraza debug log file.</p><p><strong>Syntax:</strong> SecDebugLog /path/to/coraza-debug.log</p><p><strong>Example Usage:</strong> SecDebugLog /usr/local/apache/logs/coraza-debug.log</p><p><strong>Supported:</strong> Yes</p><h2 id=secdebugloglevel>SecDebugLogLevel<a href=#secdebugloglevel class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the verboseness of the debug log data.</p><p><strong>Syntax:</strong> SecDebugLogLevel 0|1|2|3|4|5</p><p><strong>Example Usage:</strong> SecDebugLogLevel 4</p><p><strong>Supported:</strong> Yes</p><p>Messages at levels 1–3 are always copied to the Apache error log. Therefore you can always use level 0 as the default logging level in production if you are very concerned with performance. Having said that, the best value to use is 3. Higher logging levels are not recommended in production, because the heavy logging affects performance adversely.</p><p>The possible values for the debug log level are:</p><ul><li><strong>0:</strong> Fatal</li><li><strong>1:</strong> Panic</li><li><strong>2:</strong> Error</li><li><strong>3:</strong> Warning</li><li><strong>4:</strong> details of how transactions are handled</li><li><strong>5:</strong> log everything, including very detailed debugging information</li></ul><h2 id=secdefaultaction>SecDefaultAction<a href=#secdefaultaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines the default list of actions, which will be inherited by the rules in the same configuration context.</p><p><strong>Syntax:</strong> SecDefaultAction &ldquo;action1,action2,action3“</p><p><strong>Example Usage:</strong> SecDefaultAction &ldquo;phase:2,log,auditlog,deny,status:403,tag:&lsquo;SLA 24/7&rsquo;“</p><p><strong>Supported:</strong> Yes</p><p><strong>Default:</strong> phase:2,log,auditlog,pass</p><p>Every rule following a previous SecDefaultAction directive in the same configuration context will inherit its settings unless more specific actions are used. Every SecDefaultAction directive must specify a disruptive action and a processing phase and cannot contain metadata actions.</p><h2 id=secdisablebackendcompression>SecDisableBackendCompression<a href=#secdisablebackendcompression class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Disables backend compression while leaving the frontend compression enabled.</p><p><strong>Syntax:</strong> SecDisableBackendCompression On|Off</p><p><strong>Supported:</strong> TBI</p><p><strong>Default:</strong> Off</p><p>This directive is necessary in reverse proxy mode when the backend servers support response compression, but you wish to inspect response bodies. Unless you disable backend compression, Coraza will only see compressed content, which is not very useful. This directive is not necessary in embedded mode, because Coraza performs inspection before response compression takes place.</p><h2 id=sechashengine>SecHashEngine<a href=#sechashengine class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the hash engine.</p><p><strong>Syntax:</strong> SecHashEngine On|Off</p><p><strong>Example Usage:</strong> SecHashEngine On</p><p><strong>Supported:</strong> TBI</p><p><strong>Default:</strong> Off</p><p>The possible values are:</p><ul><li><strong>On:</strong> Hash engine can process the request/response data.</li><li><strong>Off:</strong> Hash engine will not process any data.</li></ul><p><strong>Note</strong>: Users must enable stream output variables and content injection.</p><h2 id=sechashkey>SecHashKey<a href=#sechashkey class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Define the key that will be used by HMAC.</p><p><strong>Syntax:</strong> SecHashKey rand|TEXT KeyOnly|SessionID|RemoteIP</p><p><strong>Example Usage:</strong> SecHashKey &ldquo;this_is_my_key&rdquo; KeyOnly</p><p><strong>Supported:</strong> TBI</p><p>Coraza hash engine will append, if specified, the user&rsquo;s session id or remote ip to the key before the MAC operation. If the first parameter is &ldquo;rand&rdquo; then a random key will be generated and used by the engine.</p><h2 id=sechashparam>SecHashParam<a href=#sechashparam class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Define the parameter name that will receive the MAC hash.</p><p><strong>Syntax:</strong> SecHashParam TEXT</p><p><strong>Example Usage:</strong> SecHashParam &ldquo;hmac&rdquo;</p><p><strong>Supported:</strong> TBI</p><p>Coraza hash engine will add a new parameter to protected HTML elements containing the MAC hash.</p><h2 id=sechashmethodrx>SecHashMethodRx<a href=#sechashmethodrx class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures what kind of HTML data the hash engine should sign based on regular expression.</p><p><strong>Syntax:</strong> SecHashMethodRx TYPE REGEX</p><p><strong>Example Usage:</strong> SecHashMethodRx HashHref &ldquo;product_info|list_product&rdquo;</p><p><strong>Supported:</strong> TBI</p><p>As a initial support is possible to protect HREF, FRAME, IFRAME and FORM ACTION html elements as well response Location header when http redirect code are sent.</p><p>The possible values for TYPE are:</p><ul><li><strong>HashHref:</strong> Used to sign href= html elements</li><li><strong>HashFormAction:</strong> Used to sign form action= html elements</li><li><strong>HashIframeSrc:</strong> Used to sign iframe src= html elements</li><li><strong>HashframeSrc:</strong> Used to sign frame src= html elements</li><li><strong>HashLocation:</strong> Used to sign Location response header</li></ul><p>Note : This directive is used to sign the elements however user must use the @validateHash operator to enforce data integrity.</p><h2 id=sechashmethodpm>SecHashMethodPm<a href=#sechashmethodpm class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures what kind of HTML data the hash engine should sign based on string search algoritm.</p><p><strong>Syntax:</strong> SecHashMethodPm TYPE &ldquo;string1 string2 string3&mldr;&rdquo;</p><p><strong>Example Usage:</strong> SecHashMethodPm HashHref &ldquo;product_info list_product&rdquo;</p><p><strong>Supported:</strong> TBI</p><p>As a initial support is possible to protect HREF, FRAME, IFRAME and FORM ACTION html elements as well response Location header when http redirect code are sent.</p><p>The possible values for TYPE are:</p><ul><li><strong>HashHref:</strong> Used to sign href= html elements</li><li><strong>HashFormAction:</strong> Used to sign form action= html elements</li><li><strong>HashIframeSrc:</strong> Used to sign iframe src= html elements</li><li><strong>HashframeSrc:</strong> Used to sign frame src= html elements</li><li><strong>HashLocation:</strong> Used to sign Location response header</li></ul><p>Note : This directive is used to sign the elements however user must use the @validateHash operator to enforce data integrity.</p><h2 id=secgeolookupdb>SecGeoLookupDb<a href=#secgeolookupdb class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines the path to the database that will be used for geolocation lookups.</p><p><strong>Syntax:</strong> SecGeoLookupDb /path/to/db</p><p><strong>Example Usage:</strong> SecGeoLookupDb /path/to/GeoLiteCity.mmdb</p><p><strong>Supported:</strong> Yes</p><p>Coraza relies on the free geolocation databases (GeoLite City and GeoLite Country) that can be obtained from MaxMind http://www.maxmind.com. Only .mmdb format is supported.</p><h2 id=sechttpblkey>SecHttpBlKey<a href=#sechttpblkey class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the user&rsquo;s registered Honeypot Project HTTP BL API Key to use with @rbl.</p><p><strong>Syntax:</strong> SecHttpBlKey [12 char access key]</p><p><strong>Example Usage:</strong> SecHttpBlKey whdkfieyhtnf</p><p><strong>Supported:</strong> TBI</p><p>If the @rbl operator uses the dnsbl.httpbl.org RBL (http://www.projecthoneypot.org/httpbl_api.php) you must provide an API key. This key is registered to individual users and is included within the RBL DNS requests.</p><h2 id=secinterceptonerror>SecInterceptOnError<a href=#secinterceptonerror class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures how to respond when rule processing fails.</p><p><strong>Syntax:</strong> SecInterceptOnError On|Off</p><p><strong>Example Usage:</strong> SecInterceptOnError On</p><p><strong>Supported:</strong> TBI</p><p>When an operator execution fails, that is it returns greater than 0, this directive configures how to react. When set to &ldquo;Off&rdquo;, the rule is just ignored and the engine will continue executing the rules in phase. When set to &ldquo;On&rdquo;, the rule will be just dropped and no more rules will be executed in the same phase, also no interception is made.</p><h2 id=secmarker>SecMarker<a href=#secmarker class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Adds a fixed rule marker that can be used as a target in a skipAfter action. A SecMarker directive essentially creates a rule that does nothing and whose only purpose is to carry the given ID.</p><p><strong>Syntax:</strong> SecMarker ID|TEXT</p><p><strong>Example Usage:</strong> SecMarker 9999</p><p><strong>Supported:</strong> Yes</p><p>The value can be either a number or a text string. The SecMarker directive is available to allow you to choose the best way to implement a skip-over. Here is an example used from the Core Rule Set:</p><pre><code>SecMarker BEGIN_HOST_CHECK

SecRule &amp;REQUEST_HEADERS:Host &quot;@eq 0&quot; \
        &quot;skipAfter:END_HOST_CHECK,phase:2,rev:'2.1.1',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;
SecRule REQUEST_HEADERS:Host &quot;^$&quot; \
        &quot;phase:2,rev:'2.1.1',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;
SecMarker END_HOST_CHECK
</code></pre><h2 id=secsensorid>SecSensorId<a href=#secsensorid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Define a sensor ID that will be present into log part H.</p><p><strong>Syntax:</strong> SecSensorId TEXT</p><p><strong>Example Usage:</strong> SecSensorId WAFSensor01</p><p><strong>Supported:</strong> TBI</p><h2 id=secremoterules>SecRemoteRules<a href=#secremoterules class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Load rules from a given file hosted on a HTTPS site.</p><p><strong>Syntax:</strong> SecRemoteRules [crypto] key https://url</p><p><strong>Example Usage:</strong> SecRemoteRules some-key https://www.yourserver.com/plain-text-rules.txt</p><p><strong>Supported:</strong> Yes</p><p>This is an optional directive that allow the user to load rules from a remote server. Notice that besides the URL the user also needs to supply a key, which could be used by the target server to provide different content for different keys.</p><p>Along with the key, supplied by the users, Coraza will also send its Unique ID and the `status call&rsquo; in the format of headers to the target web server. The following headers are used:</p><ul><li>Coraza-status</li><li>Coraza-unique-id</li><li>Coraza-key</li></ul><p>The utilization of SecRemoteRules is only allowed over TLS.</p><p><strong>Note :</strong> A valid and trusted digital certificate is expected on the end server. It is also expected that the server uses TLS, preferable TLS 1.2.</p><h2 id=secremoterulesfailaction>SecRemoteRulesFailAction<a href=#secremoterulesfailaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Action that will be taken if SecRemoteRules specify an URL that Coraza was not able to download.</p><p><strong>Syntax:</strong> SecRemoteRulesFailAction Abort|Warn</p><p><strong>Example Usage:</strong> SecRemoteRulesFailAction Abort</p><p><strong>Supported:</strong> Yes</p><p>The default action is to Abort whenever there is a problem downloading a given URL.</p><p><strong>Note :</strong> This directive also influences the behaviour of @ipMatchFromFile when used with a HTTPS URI to retrieve the remote file.</p><h2 id=secrequestbodyaccess>SecRequestBodyAccess<a href=#secrequestbodyaccess class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures whether request bodies will be buffered and processed by Coraza.</p><p><strong>Syntax:</strong> SecRequestBodyAccess On|Off</p><p><strong>Example Usage:</strong> SecRequestBodyAccess On</p><p><strong>Supported:</strong> Yes</p><p>This directive is required if you want to inspect the data transported request bodies (e.g., POST parameters). Request buffering is also required in order to make reliable blocking possible. The possible values are:</p><ul><li><strong>On:</strong> buffer request bodies</li><li><strong>Off:</strong> do not buffer request bodies</li></ul><h2 id=secrequestbodyinmemorylimit>SecRequestBodyInMemoryLimit<a href=#secrequestbodyinmemorylimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum request body size that Coraza will store in memory.</p><p><strong>Syntax:</strong> SecRequestBodyInMemoryLimit LIMIT_IN_BYTES</p><p><strong>Example Usage:</strong> SecRequestBodyInMemoryLimit 131072</p><p><strong>Supported:</strong> No</p><p><strong>Default:</strong> 131072 (128 KB)</p><p>When a multipart/form-data request is being processed, once the in-memory limit is reached, the request body will start to be streamed into a temporary file on disk.</p><h2 id=secrequestbodylimit>SecRequestBodyLimit<a href=#secrequestbodylimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum request body size Coraza will accept for buffering.</p><p><strong>Syntax:</strong> SecRequestBodyLimit LIMIT_IN_BYTES</p><p><strong>Example Usage:</strong> SecRequestBodyLimit 134217728</p><p><strong>Supported:</strong> Yes</p><p><strong>Default:</strong> 134217728 (131072 KB)</p><p>Anything over the limit will be rejected with status code 413 (Request Entity Too Large). There is a hard limit of 1 GB.</p><h2 id=secrequestbodynofileslimit>SecRequestBodyNoFilesLimit<a href=#secrequestbodynofileslimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum request body size Coraza will accept for buffering, excluding the size of any files being transported in the request. This directive is useful to reduce susceptibility to DoS attacks when someone is sending request bodies of very large sizes. Web applications that require file uploads must configure SecRequestBodyLimit to a high value, but because large files are streamed to disk, file uploads will not increase memory consumption. However, it’s still possible for someone to take advantage of a large request body limit and send non-upload requests with large body sizes. This directive eliminates that loophole.</p><p><strong>Syntax:</strong> SecRequestBodyNoFilesLimit NUMBER_IN_BYTES</p><p><strong>Example Usage:</strong> SecRequestBodyNoFilesLimit 131072</p><p><strong>Supported:</strong> No</p><p><strong>Default:</strong> 1048576 (1 MB)</p><p>Generally speaking, the default value is not small enough. For most applications, you should be able to reduce it down to 128 KB or lower. Anything over the limit will be rejected with status code 413 (Request Entity Too Large). There is a hard limit of 1 GB.</p><h2 id=secrequestbodylimitaction>SecRequestBodyLimitAction<a href=#secrequestbodylimitaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Controls what happens once a request body limit, configured with SecRequestBodyLimit, is encountered</p><p><strong>Syntax:</strong> SecRequestBodyLimitAction Reject|ProcessPartial</p><p><strong>Example Usage:</strong> SecRequestBodyLimitAction ProcessPartial</p><p><strong>Supported:</strong> Yes</p><p>By default, Coraza will reject a request body that is longer than specified. This is problematic especially when Coraza is being run in DetectionOnly mode and the intent is to be totally passive and not take any disruptive actions against the transaction. With the ability to choose what happens once a limit is reached, site administrators can choose to inspect only the first part of the request, the part that can fit into the desired limit, and let the rest through. This is not ideal from a possible evasion issue perspective, however it may be acceptable under certain circumstances.</p><p>Note : When the SecRuleEngine is set to DetectionOnly, SecRequestBodyLimitAction is automatically set to ProcessPartial in order to not cause any disruptions. If you want to know if/when a request body size is over your limit, you can create a rule to check for the existence of the INBOUND_ERROR_DATA variable.</p><h2 id=secresponsebodylimit>SecResponseBodyLimit<a href=#secresponsebodylimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum response body size that will be accepted for buffering.</p><p><strong>Syntax:</strong> SecResponseBodyLimit LIMIT_IN_BYTES</p><p><strong>Example Usage:</strong> SecResponseBodyLimit 524228</p><p><strong>Supported:</strong> Yes</p><p><strong>Default:</strong> 524288 (512 KB)</p><p>Anything over this limit will be rejected with status code 500 (Internal Server Error). This setting will not affect the responses with MIME types that are not selected for buffering. There is a hard limit of 1 GB.</p><h2 id=secresponsebodylimitaction>SecResponseBodyLimitAction<a href=#secresponsebodylimitaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Controls what happens once a response body limit, configured with SecResponseBodyLimit, is encountered.</p><p><strong>Syntax:</strong> SecResponseBodyLimitAction Reject|ProcessPartial</p><p><strong>Example Usage:</strong> SecResponseBodyLimitAction ProcessPartial</p><p><strong>Supported:</strong> Yes</p><p>By default, Coraza will reject a response body that is longer than specified. Some web sites, however, will produce very long responses, making it difficult to come up with a reasonable limit. Such sites would have to raise the limit significantly to function properly, defying the purpose of having the limit in the first place (to control memory consumption). With the ability to choose what happens once a limit is reached, site administrators can choose to inspect only the first part of the response, the part that can fit into the desired limit, and let the rest through. Some could argue that allowing parts of responses to go uninspected is a weakness. This is true in theory, but applies only to cases in which the attacker controls the output (e.g., can make it arbitrary long). In such cases, however, it is not possible to prevent leakage anyway. The attacker could compress, obfuscate, or even encrypt data before it is sent back, and therefore bypass any monitoring device.</p><h2 id=secresponsebodymimetype>SecResponseBodyMimeType<a href=#secresponsebodymimetype class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures which MIME types are to be considered for response body buffering.</p><p><strong>Syntax:</strong> SecResponseBodyMimeType MIMETYPE MIMETYPE &mldr;</p><p><strong>Example Usage:</strong> SecResponseBodyMimeType text/plain text/html text/xml</p><p><strong>Supported:</strong> Yes</p><p><strong>Default:</strong> text/plain text/html</p><p>Multiple SecResponseBodyMimeType directives can be used to add MIME types. Use SecResponseBodyMimeTypesClear to clear previously configured MIME types and start over.</p><h2 id=secresponsebodymimetypesclear>SecResponseBodyMimeTypesClear<a href=#secresponsebodymimetypesclear class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Clears the list of MIME types considered for response body buffering, allowing you to start populating the list from scratch.</p><p><strong>Syntax:</strong> SecResponseBodyMimeTypesClear</p><p><strong>Example Usage:</strong> SecResponseBodyMimeTypesClear</p><p><strong>Supported:</strong> Yes</p><h2 id=secresponsebodyaccess>SecResponseBodyAccess<a href=#secresponsebodyaccess class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures whether response bodies are to be buffered.</p><p><strong>Syntax:</strong> SecResponseBodyAccess On|Off</p><p><strong>Example Usage:</strong> SecResponseBodyAccess On</p><p><strong>Supported:</strong> Yes</p><p><strong>Default:</strong> Off</p><p>This directive is required if you plan to inspect HTML responses and implement response blocking. Possible values are:</p><ul><li><strong>On:</strong> buffer response bodies (but only if the response MIME type matches the list configured with SecResponseBodyMimeType).</li><li><strong>Off:</strong> do not buffer response bodies.</li></ul><h2 id=secrule>SecRule<a href=#secrule class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Creates a rule that will analyze the selected variables using the selected operator.</p><p><strong>Syntax:</strong> SecRule VARIABLES OPERATOR [ACTIONS]</p><p><strong>Example Usage:</strong> SecRule ARGS &ldquo;@rx attack&rdquo; &ldquo;phase:1,log,deny,id:1&rdquo;</p><p><strong>Supported:</strong> Yes</p><p>Every rule must provide one or more variables along with the operator that should be used to inspect them. If no actions are provided, the default list will be used. (There is always a default list, even if one was not explicitly set with SecDefaultAction.) If there are actions specified in a rule, they will be merged with the default list to form the final actions that will be used. (The actions in the rule will overwrite those in the default list.) Refer to SecDefaultAction for more information.</p><h2 id=secruleengine>SecRuleEngine<a href=#secruleengine class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the rules engine.</p><p><strong>Syntax:</strong> SecRuleEngine On|Off|DetectionOnly</p><p><strong>Example Usage:</strong> SecRuleEngine On</p><p><strong>Supported:</strong> Yes</p><p><strong>Default:</strong> Off</p><p>The possible values are:</p><ul><li><strong>On:</strong> process rules</li><li><strong>Off:</strong> do not process rules</li><li><strong>DetectionOnly:</strong> process rules but never executes any disruptive actions (block, deny, drop, allow, proxy and redirect)</li></ul><h2 id=secruleperftime>SecRulePerfTime<a href=#secruleperftime class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Set a performance threshold for rules. Rules that spend at least the time defined will be logged into audit log Part H as Rules-Performance-Info in the format id=usec, comma separated.</p><p><strong>Syntax:</strong> SecRulePerfTime USECS</p><p><strong>Example Usage:</strong> SecRulePerfTime 1000</p><p><strong>Supported:</strong> TBI</p><p>The rules hitting the threshold can be accessed via the collection PERF_RULES.</p><h2 id=secruleremovebyid>SecRuleRemoveById<a href=#secruleremovebyid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Removes the matching rules from the current configuration context.</p><p><strong>Syntax:</strong> SecRuleRemoveById ID ID RANGE &mldr;</p><p><strong>Example Usage:</strong> SecRuleRemoveByID 1 2 &ldquo;9000-9010&rdquo;</p><p><strong>Supported:</strong> Partially, it supports one rule per directive.</p><p>This directive supports multiple parameters, each of which can be a rule ID or a range. Parameters that contain spaces must be delimited using double quotes.</p><p>Note : This directive must be specified after the rule in which it is disabling. This should be used within local custom rule files that are processed after third party rule sets. Example file - Coraza_crs_60_customrules.conf.</p><h2 id=secruleremovebymsg>SecRuleRemoveByMsg<a href=#secruleremovebymsg class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Removes the matching rules from the current configuration context.</p><p><strong>Syntax:</strong> SecRuleRemoveByMsg REGEX</p><p><strong>Example Usage:</strong> SecRuleRemoveByMsg &ldquo;FAIL&rdquo;</p><p><strong>Supported:</strong> Yes</p><p>Normally, you would use SecRuleRemoveById to remove rules, but that requires the rules to have IDs defined. If they don’t, then you can remove them with SecRuleRemoveByMsg, which matches a regular expression against rule messages.</p><p>Note : This directive must be specified after the rule in which it is disabling. This should be used within local custom rule files that are processed after third party rule sets.</p><h2 id=secruleremovebytag>SecRuleRemoveByTag<a href=#secruleremovebytag class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Removes the matching rules from the current configuration context.</p><p><strong>Syntax:</strong> SecRuleRemoveByTag REGEX</p><p><strong>Example Usage:</strong> SecRuleRemoveByTag &ldquo;WEB_ATTACK/XSS&rdquo;</p><p><strong>Supported:</strong> Yes</p><p>Normally, you would use SecRuleRemoveById to remove rules, but that requires the rules to have IDs defined. If they don’t, then you can remove them with SecRuleRemoveByTag, which matches a regular expression against rule tag data. This is useful if you want to disable entire groups of rules based on tag data. Example tags used in the OWASP Coraza CRS include:</p><ul><li>AUTOMATION/MALICIOUS</li><li>AUTOMATION/MISC</li><li>AUTOMATION/SECURITY_SCANNER</li><li>LEAKAGE/SOURCE_CODE_ASP_JSP</li><li>LEAKAGE/SOURCE_CODE_CF</li><li>LEAKAGE/SOURCE_CODE_PHP</li><li>WEB_ATTACK/CF_INJECTION</li><li>WEB_ATTACK/COMMAND_INJECTION</li><li>WEB_ATTACK/FILE_INJECTION</li><li>WEB_ATTACK/HTTP_RESPONSE_SPLITTING</li><li>WEB_ATTACK/LDAP_INJECTION</li><li>WEB_ATTACK/PHP_INJECTION</li><li>WEB_ATTACK/REQUEST_SMUGGLING</li><li>WEB_ATTACK/SESSION_FIXATION</li><li>WEB_ATTACK/SQL_INJECTION</li><li>WEB_ATTACK/SSI_INJECTION</li><li>WEB_ATTACK/XSS</li></ul><p>Note : This directive must be specified after the rule in which it is disabling. This should be used within local custom rule files that are processed after third party rule sets. Example file - Coraza_crs_60_customrules.conf.</p><h2 id=secruleupdateactionbyid>SecRuleUpdateActionById<a href=#secruleupdateactionbyid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Updates the action list of the specified rule.</p><p><strong>Syntax:</strong> SecRuleUpdateActionById RULEID[:offset] ACTIONLIST</p><p><strong>Example Usage:</strong> SecRuleUpdateActionById 12345 &ldquo;deny,status:403&rdquo;</p><p><strong>Supported:</strong> TBI but it&rsquo;s supported by CTL</p><p>This directive will overwrite the action list of the specified rule with the actions provided in the second parameter. It has two limitations: it cannot be used to change the ID or phase of a rule. Only the actions that can appear only once are overwritten. The actions that are allowed to appear multiple times in a list, will be appended to the end of the list.</p><pre><code>SecRule ARGS attack &quot;phase:2,id:12345,t:lowercase,log,pass,msg:'Message text'&quot;
SecRuleUpdateActionById 12345 &quot;t:none,t:compressWhitespace,deny,status:403,msg:'New message text'&quot;
</code></pre><p>The effective resulting rule in the previous example will be as follows:</p><pre><code>SecRule ARGS attack &quot;phase:2,id:12345,t:lowercase,t:none,t:compressWhitespace,deny,status:403,msg:'New Message text'&quot;
</code></pre><p>The addition of t:none will neutralize any previous transformation functions specified (t:lowercase, in the example).</p><p><strong>Note :</strong> If the target rule is a chained rule, you must currently specify chain in the SecRuleUpdateActionById action list as well. This will be fixed in a future version.</p><h2 id=secruleupdatetargetbyid>SecRuleUpdateTargetById<a href=#secruleupdatetargetbyid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Updates the target (variable) list of the specified rule.</p><p><strong>Syntax:</strong> SecRuleUpdateTargetById RULEID TARGET1[,TARGET2,TARGET3] REPLACED_TARGET</p><p><strong>Example Usage:</strong> SecRuleUpdateTargetById 12345 &ldquo;!ARGS:foo&rdquo;</p><p><strong>Supported:</strong> TBI but it&rsquo;s supported by CTL</p><p>This directive will append (or replace) variables to the current target list of the specified rule with the targets provided in the second parameter.</p><p>Explicitly Appending Targets</p><p>This is useful for implementing exceptions where you want to externally update a target list to exclude inspection of specific variable(s).</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;
</code></pre><p>SecRuleUpdateTargetById 958895 !ARGS:email
The effective resulting rule in the previous example will append the target to the end of the variable list as follows:</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*|!ARGS:email &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;
</code></pre><p>Note that is is also possible to use regular expressions in the target specification:</p><pre><code>SecRuleUpdateTargetById 981172 &quot;!REQUEST_COOKIES:/^appl1_.*/&quot;
</code></pre><p><strong>Explicitly Replacing Targets</strong></p><p>You can also entirely replace the target list to something more appropriate for your environment. For example, lets say you want to inspect REQUEST_URI instead of REQUEST_FILENAME, you could do this:</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;

SecRuleUpdateTargetById 958895 REQUEST_URI REQUEST_FILENAME
</code></pre><p>The effective resulting rule in the previous example replaces the target in the begin of the variable list as follows:</p><pre><code>SecRule REQUEST_URI|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;
</code></pre><p>Note : You could also do the same by using the ctl action with the ruleRemoveById directive. That would be useful if you want to only update the targets for a particular URL, thus conditionally appending targets.</p><h2 id=secruleupdatetargetbymsg>SecRuleUpdateTargetByMsg<a href=#secruleupdatetargetbymsg class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Updates the target (variable) list of the specified rule by rule message.</p><p><strong>Syntax:</strong> SecRuleUpdateTargetByMsg TEXT TARGET1[,TARGET2,TARGET3] REPLACED_TARGET</p><p><strong>Example Usage:</strong> SecRuleUpdateTargetByMsg &ldquo;Cross-site Scripting (XSS) Attack&rdquo; &ldquo;!ARGS:foo&rdquo;</p><p><strong>Supported:</strong> TBI</p><p>This directive will append (or replace) variables to the current target list of the specified rule with the targets provided in the second parameter.</p><p>Explicitly Appending Targets</p><p>This is useful for implementing exceptions where you want to externally update a target list to exclude inspection of specific variable(s).</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;

SecRuleUpdateTargetByMsg &quot;System Command Injection&quot; !ARGS:email
</code></pre><p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*|!ARGS:email &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;
</code></pre><p>Explicitly Replacing Targets
You can also entirely replace the target list to something more appropriate for your environment. For example, lets say you want to inspect REQUEST_URI instead of REQUEST_FILENAME, you could do this:</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;

SecRuleUpdateTargetByMsg &quot;System Command Injection&quot; REQUEST_URI REQUEST_FILENAME
</code></pre><p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:</p><pre><code>SecRule REQUEST_URI|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;
</code></pre><h2 id=secruleupdatetargetbytag>SecRuleUpdateTargetByTag<a href=#secruleupdatetargetbytag class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Updates the target (variable) list of the specified rule by rule tag.</p><p><strong>Syntax:</strong> SecRuleUpdateTargetByTag TEXT TARGET1[,TARGET2,TARGET3] REPLACED_TARGET</p><p><strong>Example Usage:</strong> SecRuleUpdateTargetByTag &ldquo;WEB_ATTACK/XSS&rdquo; &ldquo;!ARGS:foo&rdquo;</p><p><strong>Supported:</strong> TBI</p><p>This directive will append (or replace) variables to the current target list of the specified rule with the targets provided in the second parameter.</p><p>Explicitly Appending Targets</p><p>This is useful for implementing exceptions where you want to externally update a target list to exclude inspection of specific variable(s).</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;

SecRuleUpdateTargetByTag &quot;WASCTC/WASC-31&quot; !ARGS:email
</code></pre><p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*|!ARGS:email &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;
</code></pre><p>Explicitly Replacing Targets</p><p>You can also entirely replace the target list to something more appropriate for your environment. For example, lets say you want to inspect REQUEST_URI instead of REQUEST_FILENAME, you could do this:</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;

SecRuleUpdateTargetByTag &quot;WASCTC/WASC-31&quot; REQUEST_URI REQUEST_FILENAME
</code></pre><p>The effective resulting rule in the previous example will append the target to the end of the variable list as follows:</p><pre><code>SecRule REQUEST_URI|ARGS_NAMES|ARGS|XML:/* &quot;[\;\|\`]\W*?\bmail\b&quot; \
     &quot;phase:2,rev:'2.1.1',capture,t:none,t:htmlEntityDecode,t:compressWhitespace,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'958895',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%
{tx.0}&quot;&quot;
</code></pre><h2 id=secunicodemap>SecUnicodeMap<a href=#secunicodemap class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines which Unicode code point will be used by the urlDecodeUni transformation function during normalization.</p><p><strong>Syntax:</strong> SecUnicodeMap CODEPOINT</p><p><strong>Example Usage:</strong> SecUnicodeMapFile 20127</p><p><strong>Supported:</strong> Yes</p><h2 id=secuploaddir>SecUploadDir<a href=#secuploaddir class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the directory where intercepted files will be stored.</p><p><strong>Syntax:</strong> SecUploadDir /path/to/dir</p><p><strong>Example Usage:</strong> SecUploadDir /tmp</p><p><strong>Supported:</strong> Yes</p><p>This directory must be on the same filesystem as the temporary directory defined with SecTmpDir. This directive is used with SecUploadKeepFiles.</p><h2 id=secuploadfilelimit>SecUploadFileLimit<a href=#secuploadfilelimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum number of file uploads processed in a multipart POST.</p><p><strong>Syntax:</strong> SecUploadFileLimit number</p><p><strong>Example Usage:</strong> SecUploadFileLimit 10</p><p><strong>Supported:</strong> Yes</p><p>The default is set to 100 files, but you are encouraged to reduce this value. Any file over the limit will not be extracted and the MULTIPART_FILE_LIMIT_EXCEEDED and MULTIPART_STRICT_ERROR flags will be set. To prevent bypassing any file checks, you must check for one of these flags.</p><p>Note : If the limit is exceeded, the part name and file name will still be recorded in FILES_NAME and FILES, the file size will be recorded in FILES_SIZES, but there will be no record in FILES_TMPNAMES as a temporary file was not created.</p><h2 id=secuploadfilemode>SecUploadFileMode<a href=#secuploadfilemode class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the mode (permissions) of any uploaded files using an octal mode (as used in chmod).</p><p><strong>Syntax:</strong> SecUploadFileMode octal_mode|&ldquo;default&rdquo;</p><p><strong>Example Usage:</strong> SecUploadFileMode 0640</p><p><strong>Supported:</strong> Yes</p><p>This feature is not available on operating systems not supporting octal file modes. The default mode (0600) only grants read/write access to the account writing the file. If access from another account is needed (using clamd is a good example), then this directive may be required. However, use this directive with caution to avoid exposing potentially sensitive data to unauthorized users. Using the value &ldquo;default&rdquo; will revert back to the default setting.</p><p>Note : The process umask may still limit the mode if it is being more restrictive than the mode set using this directive.</p><h2 id=secuploadkeepfiles>SecUploadKeepFiles<a href=#secuploadkeepfiles class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures whether or not the intercepted files will be kept after transaction is processed.</p><p><strong>Syntax:</strong> SecUploadKeepFiles On|Off|RelevantOnly</p><p><strong>Example Usage:</strong> SecUploadKeepFiles On</p><p><strong>Supported:</strong> TBI</p><p>This directive requires the storage directory to be defined (using SecUploadDir).</p><p>Possible values are:</p><ul><li><strong>On</strong> - Keep uploaded files.</li><li><strong>Off</strong> - Do not keep uploaded files.</li><li><strong>RelevantOnly</strong> - This will keep only those files that belong to requests that are deemed relevant. <strong>(Not implemented)</strong></li></ul><h2 id=secwebappid>SecWebAppId<a href=#secwebappid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Creates an application namespace, allowing for separate persistent session and user storage.</p><p><strong>Syntax:</strong> SecWebAppId &ldquo;NAME&rdquo;</p><p><strong>Example Usage:</strong> SecWebAppId &ldquo;WebApp1&rdquo;</p><p><strong>Supported:</strong> Yes</p><p><strong>Default:</strong> default</p><p>Application namespaces are used to avoid collisions between session IDs and user IDs when multiple applications are deployed on the same server. If it isn’t used, a collision between session IDs might occur.</p><p class=edit-page><a href=https://github.com/jptosso/coraza.io/blob/master/content/docs/seclang/directives.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a class=ms-auto href=https://coraza.io/docs/seclang/actions/><div class="card my-1"><div class="card-body py-2">Actions &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ❤️ (and code) - By Juan Pablo Tosso</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.0a3cc8e06de47abf2e91a48ebb20ad66756a97a290b5bfc41e312d89ba5dd12dcb3f0c463c7494b150ac6ff7a1f96648401f878e623712f908d8eab59c1dcad0.js integrity="sha512-CjzI4G3ker8ukaSOuyCtZnVql6KQtb/EHjEtibpd0S3LPwxGPHSUsVCsb/eh+WZIQB+HjmI3EvkI2Oq1nB3K0A==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.c77e1b000b036cae87dc49b64980b70a0e9320481bf597230c90c928d7b6758928152b67a257ff0f650da477f7a00670f32ec016a18e6bc762d2eafb1eabb54e.js integrity="sha512-x34bAAsDbK6H3Em2SYC3Cg6TIEgb9ZcjDJDJKNe2dYkoFStnolf/D2UNpHf3oAZw8y7AFqGOa8di0ur7Hqu1Tg==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.ed66790ef063177366c6f4a5498e8df6442cc0a4be023a326441d5ff02a8569375f2b1348e8e8ae3b0ae5a4da47ab1f867bebef09159310cbc937994ac7e5efc.js integrity="sha512-7WZ5DvBjF3NmxvSlSY6N9kQswKS+AjoyZEHV/wKoVpN18rE0jo6K47CuWk2kerH4Z76+8JFZMQy8k3mUrH5e/A==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.521fffd7b34481fec24bfebf5e645bb199120a06bddae9844734b7d8ff0ede72b403f9a25817ba21fe83e029b48190c83aa4dff0f964536b1663689719db1bcc.js integrity="sha512-Uh//17NEgf7CS/6/XmRbsZkSCga92umERzS32P8O3nK0A/miWBe6If6D4Cm0gZDIOqTf8PlkU2sWY2iXGdsbzA==" crossorigin=anonymous defer></script></body></html>